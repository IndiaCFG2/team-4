{"ast":null,"code":"/*!\r\n * body-parser\r\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\r\n * MIT Licensed\r\n */\n'use strict';\n/**\r\n * Module dependencies.\r\n * @private\r\n */\n\nvar createError = require('http-errors');\n\nvar getBody = require('raw-body');\n\nvar iconv = require('iconv-lite');\n\nvar onFinished = require('on-finished');\n\nvar zlib = require('zlib');\n/**\r\n * Module exports.\r\n */\n\n\nmodule.exports = read;\n/**\r\n * Read a request into a buffer and parse.\r\n *\r\n * @param {object} req\r\n * @param {object} res\r\n * @param {function} next\r\n * @param {function} parse\r\n * @param {function} debug\r\n * @param {object} options\r\n * @private\r\n */\n\nfunction read(req, res, next, parse, debug, options) {\n  var length;\n  var opts = options;\n  var stream; // flag as parsed\n\n  req._body = true; // read options\n\n  var encoding = opts.encoding !== null ? opts.encoding : null;\n  var verify = opts.verify;\n\n  try {\n    // get the content stream\n    stream = contentstream(req, debug, opts.inflate);\n    length = stream.length;\n    stream.length = undefined;\n  } catch (err) {\n    return next(err);\n  } // set raw-body options\n\n\n  opts.length = length;\n  opts.encoding = verify ? null : encoding; // assert charset is supported\n\n  if (opts.encoding === null && encoding !== null && !iconv.encodingExists(encoding)) {\n    return next(createError(415, 'unsupported charset \"' + encoding.toUpperCase() + '\"', {\n      charset: encoding.toLowerCase(),\n      type: 'charset.unsupported'\n    }));\n  } // read body\n\n\n  debug('read body');\n  getBody(stream, opts, function (error, body) {\n    if (error) {\n      var _error;\n\n      if (error.type === 'encoding.unsupported') {\n        // echo back charset\n        _error = createError(415, 'unsupported charset \"' + encoding.toUpperCase() + '\"', {\n          charset: encoding.toLowerCase(),\n          type: 'charset.unsupported'\n        });\n      } else {\n        // set status code on error\n        _error = createError(400, error);\n      } // read off entire request\n\n\n      stream.resume();\n      onFinished(req, function onfinished() {\n        next(createError(400, _error));\n      });\n      return;\n    } // verify\n\n\n    if (verify) {\n      try {\n        debug('verify body');\n        verify(req, res, body, encoding);\n      } catch (err) {\n        next(createError(403, err, {\n          body: body,\n          type: err.type || 'entity.verify.failed'\n        }));\n        return;\n      }\n    } // parse\n\n\n    var str = body;\n\n    try {\n      debug('parse body');\n      str = typeof body !== 'string' && encoding !== null ? iconv.decode(body, encoding) : body;\n      req.body = parse(str);\n    } catch (err) {\n      next(createError(400, err, {\n        body: str,\n        type: err.type || 'entity.parse.failed'\n      }));\n      return;\n    }\n\n    next();\n  });\n}\n/**\r\n * Get the content stream of the request.\r\n *\r\n * @param {object} req\r\n * @param {function} debug\r\n * @param {boolean} [inflate=true]\r\n * @return {object}\r\n * @api private\r\n */\n\n\nfunction contentstream(req, debug, inflate) {\n  var encoding = (req.headers['content-encoding'] || 'identity').toLowerCase();\n  var length = req.headers['content-length'];\n  var stream;\n  debug('content-encoding \"%s\"', encoding);\n\n  if (inflate === false && encoding !== 'identity') {\n    throw createError(415, 'content encoding unsupported', {\n      encoding: encoding,\n      type: 'encoding.unsupported'\n    });\n  }\n\n  switch (encoding) {\n    case 'deflate':\n      stream = zlib.createInflate();\n      debug('inflate body');\n      req.pipe(stream);\n      break;\n\n    case 'gzip':\n      stream = zlib.createGunzip();\n      debug('gunzip body');\n      req.pipe(stream);\n      break;\n\n    case 'identity':\n      stream = req;\n      stream.length = length;\n      break;\n\n    default:\n      throw createError(415, 'unsupported content encoding \"' + encoding + '\"', {\n        encoding: encoding,\n        type: 'encoding.unsupported'\n      });\n  }\n\n  return stream;\n}","map":{"version":3,"sources":["C:/Users/nithya/Desktop/team-4/client/node_modules/body-parser/lib/read.js"],"names":["createError","require","getBody","iconv","onFinished","zlib","module","exports","read","req","res","next","parse","debug","options","length","opts","stream","_body","encoding","verify","contentstream","inflate","undefined","err","encodingExists","toUpperCase","charset","toLowerCase","type","error","body","_error","resume","onfinished","str","decode","headers","createInflate","pipe","createGunzip"],"mappings":"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","sourcesContent":["/*!\r\n * body-parser\r\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\r\n * MIT Licensed\r\n */\r\n\r\n'use strict'\r\n\r\n/**\r\n * Module dependencies.\r\n * @private\r\n */\r\n\r\nvar createError = require('http-errors')\r\nvar getBody = require('raw-body')\r\nvar iconv = require('iconv-lite')\r\nvar onFinished = require('on-finished')\r\nvar zlib = require('zlib')\r\n\r\n/**\r\n * Module exports.\r\n */\r\n\r\nmodule.exports = read\r\n\r\n/**\r\n * Read a request into a buffer and parse.\r\n *\r\n * @param {object} req\r\n * @param {object} res\r\n * @param {function} next\r\n * @param {function} parse\r\n * @param {function} debug\r\n * @param {object} options\r\n * @private\r\n */\r\n\r\nfunction read (req, res, next, parse, debug, options) {\r\n  var length\r\n  var opts = options\r\n  var stream\r\n\r\n  // flag as parsed\r\n  req._body = true\r\n\r\n  // read options\r\n  var encoding = opts.encoding !== null\r\n    ? opts.encoding\r\n    : null\r\n  var verify = opts.verify\r\n\r\n  try {\r\n    // get the content stream\r\n    stream = contentstream(req, debug, opts.inflate)\r\n    length = stream.length\r\n    stream.length = undefined\r\n  } catch (err) {\r\n    return next(err)\r\n  }\r\n\r\n  // set raw-body options\r\n  opts.length = length\r\n  opts.encoding = verify\r\n    ? null\r\n    : encoding\r\n\r\n  // assert charset is supported\r\n  if (opts.encoding === null && encoding !== null && !iconv.encodingExists(encoding)) {\r\n    return next(createError(415, 'unsupported charset \"' + encoding.toUpperCase() + '\"', {\r\n      charset: encoding.toLowerCase(),\r\n      type: 'charset.unsupported'\r\n    }))\r\n  }\r\n\r\n  // read body\r\n  debug('read body')\r\n  getBody(stream, opts, function (error, body) {\r\n    if (error) {\r\n      var _error\r\n\r\n      if (error.type === 'encoding.unsupported') {\r\n        // echo back charset\r\n        _error = createError(415, 'unsupported charset \"' + encoding.toUpperCase() + '\"', {\r\n          charset: encoding.toLowerCase(),\r\n          type: 'charset.unsupported'\r\n        })\r\n      } else {\r\n        // set status code on error\r\n        _error = createError(400, error)\r\n      }\r\n\r\n      // read off entire request\r\n      stream.resume()\r\n      onFinished(req, function onfinished () {\r\n        next(createError(400, _error))\r\n      })\r\n      return\r\n    }\r\n\r\n    // verify\r\n    if (verify) {\r\n      try {\r\n        debug('verify body')\r\n        verify(req, res, body, encoding)\r\n      } catch (err) {\r\n        next(createError(403, err, {\r\n          body: body,\r\n          type: err.type || 'entity.verify.failed'\r\n        }))\r\n        return\r\n      }\r\n    }\r\n\r\n    // parse\r\n    var str = body\r\n    try {\r\n      debug('parse body')\r\n      str = typeof body !== 'string' && encoding !== null\r\n        ? iconv.decode(body, encoding)\r\n        : body\r\n      req.body = parse(str)\r\n    } catch (err) {\r\n      next(createError(400, err, {\r\n        body: str,\r\n        type: err.type || 'entity.parse.failed'\r\n      }))\r\n      return\r\n    }\r\n\r\n    next()\r\n  })\r\n}\r\n\r\n/**\r\n * Get the content stream of the request.\r\n *\r\n * @param {object} req\r\n * @param {function} debug\r\n * @param {boolean} [inflate=true]\r\n * @return {object}\r\n * @api private\r\n */\r\n\r\nfunction contentstream (req, debug, inflate) {\r\n  var encoding = (req.headers['content-encoding'] || 'identity').toLowerCase()\r\n  var length = req.headers['content-length']\r\n  var stream\r\n\r\n  debug('content-encoding \"%s\"', encoding)\r\n\r\n  if (inflate === false && encoding !== 'identity') {\r\n    throw createError(415, 'content encoding unsupported', {\r\n      encoding: encoding,\r\n      type: 'encoding.unsupported'\r\n    })\r\n  }\r\n\r\n  switch (encoding) {\r\n    case 'deflate':\r\n      stream = zlib.createInflate()\r\n      debug('inflate body')\r\n      req.pipe(stream)\r\n      break\r\n    case 'gzip':\r\n      stream = zlib.createGunzip()\r\n      debug('gunzip body')\r\n      req.pipe(stream)\r\n      break\r\n    case 'identity':\r\n      stream = req\r\n      stream.length = length\r\n      break\r\n    default:\r\n      throw createError(415, 'unsupported content encoding \"' + encoding + '\"', {\r\n        encoding: encoding,\r\n        type: 'encoding.unsupported'\r\n      })\r\n  }\r\n\r\n  return stream\r\n}\r\n"]},"metadata":{},"sourceType":"script"}